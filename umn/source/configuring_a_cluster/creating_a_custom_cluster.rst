:original_name: mrs_01_0513.html

.. _mrs_01_0513:

Creating a Custom Cluster
=========================

The first step of using MRS is to create a cluster. This section describes how to create a cluster on the **Custom Config** tab of the MRS management console.

You can create an IAM user or user group on the IAM management console and grant it specific operation permissions, to perform refined resource management after registering an account. For details, see :ref:`Creating an MRS User <mrs_01_0453>`.

#. Log in to the MRS console.

#. Click **Create Cluster**. The page for creating a cluster is displayed.

   .. note::

      When creating a cluster, pay attention to quota notification. If a resource quota is insufficient, increase the resource quota as prompted and create a cluster.

#. Click the **Custom Config** tab.

#. Configure cluster information by referring to :ref:`Software Configurations <mrs_01_0513__section48591411155214>` and click **Next**.

#. Configure cluster information by referring to :ref:`Hardware Configurations <mrs_01_0513__section1055918551>` and click **Next**.

#. Set advanced options by referring to :ref:`(Optional) Advanced Configuration <mrs_01_0513__section15766698552>` and click **Apply Now**.

   If Kerberos authentication is enabled for a cluster, check whether Kerberos authentication is required. If yes, click **Continue**. If no, click **Back** to disable Kerberos authentication and then create a cluster.

   .. note::

      For any doubt about the pricing, click **Pricing details** in the lower left corner.

#. Click **Back to Cluster List** to view the cluster status.

   For details about cluster status during creation, see the description of the status parameters in :ref:`Table 1 <en-us_topic_0012808230__table3950169215120>`.

   It takes some time to create a cluster. The initial status of the cluster is **Starting**. After the cluster has been created successfully, the cluster status becomes **Running**.

   On the MRS management console, a maximum of 10 clusters can be concurrently created, and a maximum of 100 clusters can be managed.

.. _mrs_01_0513__section48591411155214:

Software Configurations
-----------------------

.. table:: **Table 1** MRS cluster software configuration

   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                         | Description                                                                                                                                                                                                                                                                          |
   +===================================+======================================================================================================================================================================================================================================================================================+
   | Region                            | Select a region.                                                                                                                                                                                                                                                                     |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | Cloud service products in different regions cannot communicate with each other over an intranet. For low network latency and quick access, select the nearest region.                                                                                                                |
   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Cluster Name                      | The cluster name must be unique.                                                                                                                                                                                                                                                     |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | A cluster name can contain 1 to 64 characters. Only letters, digits, hyphens (-), and underscores (_) are allowed.                                                                                                                                                                   |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | The default name is **mrs**\ \_\ *xxxx*. *xxxx* is a random collection of letters and digits.                                                                                                                                                                                        |
   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Cluster Version                   | Currently, MRS 3.1.2-LTS.6 , and 3.2.0-LTS.2 are supported. The default value displayed on the UI varies depending on the version.                                                                                                                                                   |
   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Cluster Type                      | The cluster types are as follows:                                                                                                                                                                                                                                                    |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | -  **Analysis cluster**: is used for offline data analysis and provides Hadoop components.                                                                                                                                                                                           |
   |                                   | -  **Streaming cluster**: is used for streaming tasks and provides stream processing components.                                                                                                                                                                                     |
   |                                   | -  **Hybrid cluster**: is used for both offline data analysis and streaming processing and provides Hadoop components and streaming processing components. You are advised to use a hybrid cluster to perform offline data analysis and streaming processing tasks at the same time. |
   |                                   | -  **Custom**: You can adjust the cluster service deployment mode based on service requirements. For details, see :ref:`Creating a Custom Topology Cluster <mrs_01_0121>`.                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | .. note::                                                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   |    -  MRS streaming clusters do not support job and file management functions.                                                                                                                                                                                                       |
   |                                   |    -  To install all components in a cluster, select **Custom**.                                                                                                                                                                                                                     |
   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Components                        | MRS components are as follows..                                                                                                                                                                                                                                                      |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | **Components of an analysis cluster:**                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | -  Presto: open source and distributed SQL query engine                                                                                                                                                                                                                              |
   |                                   | -  Hadoop: distributed system architecture                                                                                                                                                                                                                                           |
   |                                   | -  Spark2x: A fast general-purpose engine for large-scale data processing. It is developed based on the open-source Spark2.x version.                                                                                                                                                |
   |                                   | -  Hive: data warehouse framework built on Hadoop                                                                                                                                                                                                                                    |
   |                                   | -  HBase: distributed column-oriented database                                                                                                                                                                                                                                       |
   |                                   | -  Tez: an application framework which allows for a complex directed-acyclic-graph of tasks for processing data                                                                                                                                                                      |
   |                                   | -  Hue: provides the Hadoop UI capability, which enables users to analyze and process Hadoop cluster data on browsers                                                                                                                                                                |
   |                                   | -  Flink: a distributed big data processing engine that can perform stateful computations over both finite and infinite data streams                                                                                                                                                 |
   |                                   | -  Oozie: a Hadoop job scheduling system                                                                                                                                                                                                                                             |
   |                                   | -  HetuEngine: a distributed SQL query engine for heterogeneous big data sets                                                                                                                                                                                                        |
   |                                   | -  Ranger: a framework to enable, monitor, and manage data security across the Hadoop platform                                                                                                                                                                                       |
   |                                   | -  ClickHouse: A column database management system (DBMS) for on-line analytical processing (OLAP).                                                                                                                                                                                  |
   |                                   | -  Kudu: a column-oriented data store                                                                                                                                                                                                                                                |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | **Components of a streaming cluster:**                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                      |
   |                                   | -  Kafka: distributed messaging system                                                                                                                                                                                                                                               |
   |                                   | -  Flume: distributed, reliable, and available service for efficiently collecting, aggregating, and moving large amounts of log data                                                                                                                                                 |
   |                                   | -  ZooKeeper: a centralized service for maintaining configuration information, naming, providing distributed synchronization, and providing group services                                                                                                                           |
   |                                   | -  Ranger: a framework to enable, monitor, and manage data security across the Hadoop platform                                                                                                                                                                                       |
   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Component Port                    | Use the default **Open source**.                                                                                                                                                                                                                                                     |
   +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _mrs_01_0513__section1055918551:

Hardware Configurations
-----------------------

.. table:: **Table 2** MRS cluster hardware configuration

   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   +===================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | AZ                                | Select the AZ associated with the region of the cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | An AZ is a physical area that uses independent power and network resources. AZs are physically isolated but interconnected through the internal network. This improves the availability of applications. You are advised to create clusters in different AZs.                                                                                                                                                                                                                                                                                                                     |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | VPC                               | A VPC is a secure, isolated, and logical network environment.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | Select the VPC for which you want to create a cluster and click **View VPC** to view the name and ID of the VPC. If no VPC is available, create one.                                                                                                                                                                                                                                                                                                                                                                                                                              |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Subnet                            | A subnet provides dedicated network resources that are isolated from other networks, improving network security.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | Select the subnet for which you want to create a cluster. Click **View Subnet** to view details about the selected subnet. If no subnet is created in the VPC, go to the VPC console and choose **Subnets** > **Create Subnet** to create one. For details about how to configure network ACL outbound rules, see :ref:`How Do I Configure a Network ACL Outbound Rule? <mrs_01_24259__section1070017367443>`                                                                                                                                                                     |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    In MRS, IP addresses are automatically assigned to clusters during cluster creation basically based on the following formula: Quantity of IP addresses = Number of cluster nodes + 2 (one for Manager; one for the DB). In addition, if the Hadoop, Hue, Sqoop, and Presto or Loader and Presto components are selected during cluster deployment, one IP address is added for each component. To create a ClickHouse cluster independently, the number of IP addresses required is calculated as follows: Number of IP addresses = Number of cluster nodes + 1 (for Manager). |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Security Group                    | A security group is a set of ECS access rules. It provides access policies for ECSs that have the same security protection requirements and are mutually trusted in a VPC.                                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | When you create a cluster, you can select **Auto create** from the drop-down list of **Security Group** to create a security group or select an existing security group.                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    When you select a security group created by yourself, ensure that the inbound rule contains a rule in which **Protocol** is set to **All**, **Port** is set to **All**, and **Source** is set to a trusted accessible IP address range. Do not use **0.0.0.0/0** as a source address. Otherwise, security risks may occur. If you do not know the trusted accessible IP address range, select **Auto create**.                                                                                                                                                                 |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | EIP                               | After binding an EIP to an MRS cluster, you can use the EIP to access the Manager web UI of the cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | When creating a cluster, you can select an available EIP from the drop-down list and bind it. If no EIP is available in the drop-down list, click **Manage EIP** to access the **EIPs** service page to create one.                                                                                                                                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    This parameter is valid only in MRS 1.8.0 or later.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    The EIP must be in the same region as the cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Enterprise Project                | Select the enterprise project to which the cluster belongs. To use an enterprise project, create one on the **Enterprise** > **Project Management** page.                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | The **Enterprise Management** console of the enterprise project is designed for resource management. It helps enterprises manage cloud-based personnel, resources, permissions, and finance in a hierarchical manner, such as management of companies, departments, and projects.                                                                                                                                                                                                                                                                                                 |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 3** Cluster node information

   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                                |
   +===================================+============================================================================================================================================================================================================================================================================================================================================================================================================+
   | Common Node Configurations        | This parameter is valid only when **Cluster Type** is set to **Custom**. For details, see :ref:`Custom Cluster Template Description <mrs_01_0121__section126281336123311>`.                                                                                                                                                                                                                                |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Node Type                         | MRS provides three types of nodes:                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  Master: A Master node in an MRS cluster manages the cluster, assigns executable cluster files to Core nodes, traces the execution status of each job, and monitors the DataNode running status.                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  Core: A Core node in a cluster processes data and stores process data in HDFS. Analysis Core nodes are created in an analysis cluster. Streaming Core nodes are created in a streaming cluster. Both analysis and streaming Core nodes are created in a hybrid cluster.                                                                                                                                 |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  Task: A Task node in a cluster is used for computing and does not store persistent data. Yarn and Storm are mainly installed on Task nodes. Task nodes are optional, and the number of Task nodes can be zero. Analysis Task nodes are created in an analysis cluster. Streaming Task nodes are created in a streaming cluster. Both analysis and streaming Task nodes are created in a hybrid cluster. |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    When the data volume change is small in a cluster but the cluster's service processing capabilities need to be remarkably and temporarily improved, add Task nodes to address the following situations:                                                                                                                                                                                                 |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    -  Service volumes temporarily increase, for example, report processing at the end of the year.                                                                                                                                                                                                                                                                                                         |
   |                                   |    -  Long-term tasks must be completed in a short time, for example, some urgent analysis tasks.                                                                                                                                                                                                                                                                                                          |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Instance Specifications           | Instance specifications of Master or Core nodes. MRS supports host specifications determined by CPU, memory, and disk space. Click |image1| to configure the instance specifications, system disk, and data disk parameters of the cluster node.                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    -  More advanced instance specifications provide better data processing.                                                                                                                                                                                                                                                                                                                                |
   |                                   |    -  If you select non-HDD disks for Core nodes, the disk types of Master and Core nodes are determined by **Data Disk**.                                                                                                                                                                                                                                                                                 |
   |                                   |    -  The memory of the master node must be greater than 64 GB.                                                                                                                                                                                                                                                                                                                                            |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | System Disk                       | Storage type and storage space of the system disk on a node.                                                                                                                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | Storage type can be any of the following:                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  SATA: common I/O                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                   | -  SAS: high I/O                                                                                                                                                                                                                                                                                                                                                                                           |
   |                                   | -  SSD: ultra-high I/O                                                                                                                                                                                                                                                                                                                                                                                     |
   |                                   | -  GPSSD: general-purpose SSD                                                                                                                                                                                                                                                                                                                                                                              |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Data Disk                         | Data disk storage space of a node. To increase data storage capacity, you can add disks at the same time when creating a cluster. The following two application scenarios are involved.                                                                                                                                                                                                                    |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  Data storage and computing are separated. Data is stored in OBS, which features low cost and unlimited storage capacity. The clusters can be terminated at any time in OBS. The computing performance is determined by OBS access performance and is lower than that of HDFS. This configuration is recommended if data computing is infrequent.                                                        |
   |                                   | -  Data storage and computing are not separated. Data is stored in HDFS, which features high cost, high computing performance, and limited storage capacity. Before terminating clusters, you must export and store the data. This configuration is recommended if data computing is frequent.                                                                                                             |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | The storage type can be any of the following:                                                                                                                                                                                                                                                                                                                                                              |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  SATA: common I/O                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                   | -  SAS: high I/O                                                                                                                                                                                                                                                                                                                                                                                           |
   |                                   | -  SSD: ultra-high I/O                                                                                                                                                                                                                                                                                                                                                                                     |
   |                                   | -  GPSSD: general-purpose SSD                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    More nodes in a cluster require higher disk capacity of Master nodes. To ensure stable cluster running, set the disk capacity of the Master node to over 600 GB if the number of nodes is 300 and increase it to over 1 TB if the number of nodes reaches 500.                                                                                                                                          |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Instance Count                    | Number of Master and Core nodes.                                                                                                                                                                                                                                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | For Master nodes:                                                                                                                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | -  If **Cluster HA** is enabled, the number of Master nodes is fixed to **2**.                                                                                                                                                                                                                                                                                                                             |
   |                                   | -  If **Cluster HA** is disabled, the number of Master nodes is fixed to **1**.                                                                                                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | At least one Core node must exist and the total number of Core and Task nodes cannot exceed 500.                                                                                                                                                                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | Task: Click |image2| to add a Task node. Click |image3| to modify the instance specifications and disk configuration of a Task node. Click |image4| to delete the added Task node.                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    -  A maximum of 500 Core nodes are supported by default. If more than 500 Core nodes are required, contact technical support.                                                                                                                                                                                                                                                                           |
   |                                   |    -  A small number of nodes may cause clusters to run slowly while a large number of nodes may be unnecessarily costly. Set an appropriate value based on data to be processed.                                                                                                                                                                                                                          |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Topology Adjustment               | If the deployment mode in the **Common Node** does not meet the requirements, set **Topology Adjustment** to **Enable** and adjust the instance deployment mode based on service requirements. For details, see :ref:`Topology Adjustment for a Custom Cluster <mrs_01_0121__section1948791193417>`. This parameter is valid only when **Cluster Type** is set to **Custom**.                              |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _mrs_01_0513__section15766698552:

(Optional) Advanced Configuration
---------------------------------

.. table:: **Table 4** MRS cluster advanced configuration topology

   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   +===================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | Tag                               | For details, see :ref:`Adding a Tag to a Cluster <mrs_01_0048>`.                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Hostname Prefix                   | Enter the prefix for the computer hostname of an ECS in the cluster.                                                                                                                                                                                                                                                                                                                                                                                                                               |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Auto Scaling                      | Auto scaling can be configured only after you specify Task node specifications in the **Configure Hardware** step. For details about how to configure Task node specifications, see :ref:`Configuring an Auto Scaling Rule <mrs_01_0061>`.                                                                                                                                                                                                                                                         |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Agency                            | By binding an agency, ECSs or BMSs can manage some of your resources. Determine whether to configure an agency based on the actual service scenario.                                                                                                                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | For example, you can configure an agency of the ECS type to automatically obtain the AK/SK to access OBS. For details, see :ref:`Configuring a Storage-Compute Decoupled Cluster (Agency) <mrs_01_0768>`.                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | The **MRS_ECS_DEFAULT_AGENCY** agency has the OBSOperateAccess permission of OBS and the CESFullAccess (for users who have enabled fine-grained policies), CES Administrator, and KMS Administrator permissions in the region where the cluster is located.                                                                                                                                                                                                                                        |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Alarm                             | If the alarm function is enabled, the cluster maintenance personnel can be notified in a timely manner to locate faults when the cluster runs abnormally or the system is faulty.                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Rule Name                         | Name of the rule for sending alarm messages. The value can contain only digits, letters, hyphens (-), and underscores (_).                                                                                                                                                                                                                                                                                                                                                                         |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Topic Name                        | Select an existing topic or click **Create Topic** to create a topic. To deliver messages published to a topic, you need to add a subscriber to the topic. For details, see :ref:`Adding Subscriptions to a Topic <mrs_01_0062__section186691424145018>`.                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | A topic serves as a message sending channel, where publishers and subscribers can interact with each other.                                                                                                                                                                                                                                                                                                                                                                                        |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Logging                           | Whether to collect logs when cluster creation fails.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | After the logging function is enabled, system logs and component run logs are automatically collected and saved to the OBS file system in scenarios such as cluster creation failures and scale-out or scale-in failures for O&M personnel to quickly locate faults. The log information is retained for a maximum of seven days.                                                                                                                                                                  |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Kerberos Authentication           | Whether to enable Kerberos authentication when logging in to Manager.                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | -  |image5|: If **Kerberos Authentication** is disabled, common users can use all functions of an MRS cluster. You are advised to disable Kerberos authentication in single-user scenarios.                                                                                                                                                                                                                                                                                                        |
   |                                   | -  |image6|: If **Kerberos Authentication** is enabled, common users cannot use the file and job management functions of an MRS cluster and cannot view cluster resource usage or the job records for Hadoop and Spark. To use more cluster functions, the users must contact the Manager administrator to assign more permissions. You are advised to enable Kerberos authentication in multi-user scenarios.                                                                                     |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Username                          | Name of the administrator of Manager. **admin** is used by default.                                                                                                                                                                                                                                                                                                                                                                                                                                |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Password                          | Password of the Manager administrator                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | The following requirements must be met:                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | -  Must contain 8 to 26 characters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   |                                   | -  Must contain at least four of the following:                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    -  Lowercase letters                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    -  Uppercase letters                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    -  Digits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                                   |    -  Have at least one of the following special characters: !?,.: -_{} [ ]@ $% ^ + = /                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | -  Cannot be the same as the username or the username spelled backwards.                                                                                                                                                                                                                                                                                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | Password Strength: The colorbar in red, orange, and green indicates weak, medium, and strong password, respectively.                                                                                                                                                                                                                                                                                                                                                                               |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Confirm Password                  | Enter the password of the Manager administrator again.                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Login Mode                        | -  Password                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    You can log in to ECS nodes using a password.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    A password must meet the following requirements:                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    #. Must be a string and 8 to 26 characters long.                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   |                                   |    #. The password must contain at least four types of the following characters: uppercase letters, lowercase letters, digits, and special characters (``! ?,.: -_{} [ ]@ $% ^ + = /``).                                                                                                                                                                                                                                                                                                           |
   |                                   |    #. The password cannot be the username or the reverse username.                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | -  Key Pair                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    Key pairs are used to log in to ECS nodes of the cluster. Select a key pair from the drop-down list. Select "I acknowledge that I have obtained private key file *SSHkey-xxx* and that without this file I will not be able to log in to my ECS." If you have never created a key pair, click **View Key Pair** to create or import a key pair. And then, obtain a private key file.                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    A key pair, also called an SSH key, consists of a public key and a private key. You can create an SSH key and download the private key for authenticating remote login. For security, a private key can only be downloaded once. Keep it secure.                                                                                                                                                                                                                                                |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    Use an SSH key in either of the following two methods:                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    #. Creating an SSH key: After you create an SSH key, a public key and a private key are generated. The public key is stored in the system, and the private key is stored in the local ECS. When you log in to an ECS, the public and private keys are used for authentication.                                                                                                                                                                                                                  |
   |                                   |    #. Importing an SSH key: If you have obtained the public and private keys, import the public key into the system. When you log in to an ECS, the public and private keys are used for authentication.                                                                                                                                                                                                                                                                                           |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Secure Communications             | MRS clusters provision, manage, and use big data components through the management console. Big data components are deployed in a user's VPC. If the MRS management console needs to directly access big data components deployed in the user's VPC, you need to enable the corresponding security group rules after you have obtained user authorization. This authorization process is called secure communications. For details, see :ref:`Communication Security Authorization <mrs_01_0786>`. |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   | If the secure communications function is not enabled, MRS clusters cannot be created.                                                                                                                                                                                                                                                                                                                                                                                                              |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Failed to Create a Cluster
--------------------------

If a cluster fails to be created, the failed task will be managed on the **Manage Failed Tasks** page. Choose **Clusters** > **Active Clusters**. Click |image7| shown in :ref:`Figure 1 <mrs_01_0513__f4c81759110fa400ea01c1805b7817d30>` to go to the **Manage Failed Tasks** page. In the **Status** column, hover the cursor over |image8| to view the failure cause. You can delete failed tasks by referring to :ref:`Viewing Failed MRS Tasks <mrs_01_0043>`.

.. _mrs_01_0513__f4c81759110fa400ea01c1805b7817d30:

.. figure:: /_static/images/en-us_image_0000001296217700.png
   :alt: **Figure 1** Failed task management

   **Figure 1** Failed task management

:ref:`Table 5 <mrs_01_0513__ta32348b05460406dbdc7db739e0fbb38>` lists the error codes of MRS cluster creation failures.

.. _mrs_01_0513__ta32348b05460406dbdc7db739e0fbb38:

.. table:: **Table 5** Error codes

   +------------+------------------------------------------------------------------------------------------------+
   | Error Code | Description                                                                                    |
   +============+================================================================================================+
   | MRS.101    | Insufficient quota to meet your request. Contact customer service to increase the quota.       |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.102    | The token cannot be null or invalid. Try again later or contact customer service.              |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.103    | Invalid request. Try again later or contact customer service.                                  |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.104    | Insufficient resources. Try again later or contact customer service.                           |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.105    | Insufficient IP addresses in the existing subnet. Try again later or contact customer service. |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.201    | Failed due to an ECS error. Try again later or contact customer service.                       |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.202    | Failed due to an IAM error. Try again later or contact customer service.                       |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.203    | Failed due to a VPC error. Try again later or contact customer service.                        |
   +------------+------------------------------------------------------------------------------------------------+
   | MRS.400    | MRS system error. Try again later or contact customer service.                                 |
   +------------+------------------------------------------------------------------------------------------------+

.. |image1| image:: /_static/images/en-us_image_0000001296057872.png
.. |image2| image:: /_static/images/en-us_image_0000001349137577.png
.. |image3| image:: /_static/images/en-us_image_0000001296057872.png
.. |image4| image:: /_static/images/en-us_image_0000001296058072.png
.. |image5| image:: /_static/images/en-us_image_0000001295898232.png
.. |image6| image:: /_static/images/en-us_image_0000001349057905.png
.. |image7| image:: /_static/images/en-us_image_0000001349057753.jpg
.. |image8| image:: /_static/images/en-us_image_0000001349057753.jpg
