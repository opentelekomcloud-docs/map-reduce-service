:original_name: admin_guide_000101.html

.. _admin_guide_000101:

Adding a Tenant
===============

Scenario
--------

You can create tenants on FusionInsight Manager based on the resource consumption and isolation planning and requirements of services.

Prerequisites
-------------

-  A tenant name has been planned based on service requirements. The name cannot be the same as that of a role, HDFS directory, or Yarn queue that exists in the current cluster.
-  Resources to be allocated to the current tenant have been planned to ensure that the sum of resources of direct sub-tenants at each level does not exceed the resources of the current tenant.

Procedure
---------

#. Log in to FusionInsight Manager and choose **Tenant Resources**.

#. Click |image1|. On the page that is displayed, configure tenant attributes according to :ref:`Table 1 <admin_guide_000101__en-us_topic_0165590104_t41dbef6c05f84b128695138843bed278>`.

   .. _admin_guide_000101__en-us_topic_0165590104_t41dbef6c05f84b128695138843bed278:

   .. table:: **Table 1** Tenant parameters

      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      +====================================+==============================================================================================================================================================================================================================================================================================================================================================================================================================================+
      | Cluster                            | Indicates the cluster for which you want to create a tenant.                                                                                                                                                                                                                                                                                                                                                                                 |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Name                               | -  Indicates the name of the current tenant. The value consists of 3 to 50 characters, including digits, letters, and underscores (_).                                                                                                                                                                                                                                                                                                       |
      |                                    | -  Plan a tenant name based on service requirements. The name cannot be the same as that of a role, HDFS directory, or Yarn queue that exists in the current cluster.                                                                                                                                                                                                                                                                        |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Tenant Resource Type               | Specifies whether the tenant is a leaf tenant.                                                                                                                                                                                                                                                                                                                                                                                               |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  When **Leaf Tenant** **Resource** is selected, the current tenant is a leaf tenant and no sub-tenant can be added.                                                                                                                                                                                                                                                                                                                        |
      |                                    | -  When **Non-leaf Tenant** **Resource** is selected, the current tenant is not a leaf tenant and sub-tenants can be added to the current tenant.                                                                                                                                                                                                                                                                                            |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Computing Resource                 | Specifies the dynamic computing resources for the current tenant.                                                                                                                                                                                                                                                                                                                                                                            |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  When **Yarn** is selected, the system automatically creates a queue in Yarn and the queue is named the same as the tenant name.                                                                                                                                                                                                                                                                                                           |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    |    -  A leaf tenant can directly submit jobs to the queue.                                                                                                                                                                                                                                                                                                                                                                                   |
      |                                    |    -  A non-leaf tenant cannot directly submit jobs to the queue. However, Yarn adds an extra queue (hidden) named **default** for the non-leaf tenant to record the remaining resource capacity of the tenant. Actual jobs do not run in this queue.                                                                                                                                                                                        |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  If **Yarn** is not selected, the system does not automatically create a queue.                                                                                                                                                                                                                                                                                                                                                            |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Configuration Mode                 | Indicates the configuration mode of computing resource parameters.                                                                                                                                                                                                                                                                                                                                                                           |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  If you select **Basic**, you only need to set **Default Resource Pool Capacity (%)**.                                                                                                                                                                                                                                                                                                                                                     |
      |                                    | -  If you select **Advanced**, you can manually configure the resource allocation weight and the minimum, maximum, and reserved resources of the tenant.                                                                                                                                                                                                                                                                                     |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Default Resource Pool Capacity (%) | Indicates the percentage of computing resources used by the current tenant in the default resource pool. The value ranges from **0** to **100%**.                                                                                                                                                                                                                                                                                            |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Weight                             | Indicates the resource allocation weight. The value ranges from **0** to **100**.                                                                                                                                                                                                                                                                                                                                                            |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Minimum Resource                   | Indicates the resources guaranteed for the tenant (preemption supported). The value can be a percentage or an absolute value of the parent tenant's resources. When a tenant has a light workload, the resources of the tenant are automatically allocated to other tenants. When the available tenant resources are less than the value of **Minimum Resource**, the tenant can preempt the resources that have been lent to other tenants. |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Maximum Resource                   | Indicates the maximum resources that can be used by the tenant. The tenant cannot obtain more resources than the value configured. The value can be a percentage or an absolute value of the parent tenant's resources.                                                                                                                                                                                                                      |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Reserved Resource                  | Indicates the resources reserved for the tenant. The reserved resources cannot be used by other tenants even if no job is running in the current tenant resources. The value can be a percentage or an absolute value of the parent tenant's resources.                                                                                                                                                                                      |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Storage Resource                   | Specifies storage resources for the current tenant.                                                                                                                                                                                                                                                                                                                                                                                          |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  When **HDFS** is selected, the system automatically allocates storage resources.                                                                                                                                                                                                                                                                                                                                                          |
      |                                    | -  When **HDFS** is not selected, the system does not automatically allocate storage resources.                                                                                                                                                                                                                                                                                                                                              |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Quota                              | Indicates the quota for files and directories.                                                                                                                                                                                                                                                                                                                                                                                               |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Space Quota                        | Indicates the quota for the HDFS storage space used by the current tenant.                                                                                                                                                                                                                                                                                                                                                                   |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  If the unit is set to **MB**, the value ranges from **1** to **8796093022208**. If the unit is set to **GB**, the value ranges from **1** to **8589934592**.                                                                                                                                                                                                                                                                              |
      |                                    | -  This parameter indicates the maximum HDFS storage space that can be used by the tenant, but not the actual space used.                                                                                                                                                                                                                                                                                                                    |
      |                                    | -  If its value is greater than the size of the HDFS physical disk, the maximum space available is the full space of the HDFS physical disk.                                                                                                                                                                                                                                                                                                 |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Storage Path                       | Indicates the HDFS storage directory for the tenant.                                                                                                                                                                                                                                                                                                                                                                                         |
      |                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                    | -  The system automatically creates a folder named after the tenant name in the **/tenant** directory by default. For example, the default HDFS storage directory for tenant **ta1** is **/tenant/ta1**.                                                                                                                                                                                                                                     |
      |                                    | -  When a tenant is created for the first time, the system creates the **/tenant** directory in the HDFS root directory. The storage path is customizable.                                                                                                                                                                                                                                                                                   |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Service                            | Specifies whether to associate resources of other services. For details, see :ref:`4 <admin_guide_000101__en-us_topic_0165590104_l95df8df02a794fd7adb2f27cfcb5c042>`.                                                                                                                                                                                                                                                                        |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Description                        | Indicates the description of the current tenant.                                                                                                                                                                                                                                                                                                                                                                                             |
      +------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      Roles, computing resources, and storage resources are automatically created when tenants are created.

      -  The new role has permissions on the computing and storage resources. This role and its permissions are automatically controlled by the system and cannot be manually managed by choosing **System** > **Permission** > **Role**. The role name is in the format of *Tenant name*\ \_\ *Cluster ID*. The ID of the first cluster is not displayed by default.
      -  When using this tenant, create a system user and bind the user to the role of the tenant. For details, see :ref:`Adding a User and Binding the User to a Tenant Role <admin_guide_000103>`.
      -  During the tenant creation, the system automatically creates a Yarn queue named after the tenant. If the queue name already exists, the new queue is named **Tenant name-**\ *N*. *N* indicates a natural number starting from **1**. When a same name exists, the value *N* increases automatically to differentiate the queue from others. For example, **saletenant**, **saletenant-1**, and **saletenant-2**.

#. Check whether the current tenant needs to be associated with resources of other services.

   -  If yes, go to :ref:`4 <admin_guide_000101__en-us_topic_0165590104_l95df8df02a794fd7adb2f27cfcb5c042>`.
   -  If no, go to :ref:`5 <admin_guide_000101__en-us_topic_0165590104_lea52c6efc12849b4aca946b1c510728d>`.

#. .. _admin_guide_000101__en-us_topic_0165590104_l95df8df02a794fd7adb2f27cfcb5c042:

   Click **Associate Service** to configure other service resources used by the current tenant, and click **OK**.

   -  Set **Service** to **HBase** and **Association Type** to **Exclusive** or **Shared**.

      .. note::

         -  **Exclusive** indicates that the service resources are used by the tenant exclusively and cannot be associated with other tenants.
         -  **Shared** indicates that the service resources can be shared with other tenants.

   .. note::

      -  Only HBase can be associated with a new tenant. However, HDFS, HBase, and Yarn can be associated with existing tenants.
      -  To associate an existing tenant with service resources, click the target tenant in the tenant list, switch to the **Service Associations** page, and click **Associate Service** to configure resources to be associated with the tenant.
      -  To disassociate an existing tenant from service resources, click the target tenant in the tenant list, switch to the **Service Associations** page, and click **Delete** in the **Operation** column. In the displayed dialog box, select **I have read the information and understand the impact** and click **OK**.

#. .. _admin_guide_000101__en-us_topic_0165590104_lea52c6efc12849b4aca946b1c510728d:

   Click **OK**. Wait until the system displays a message indicating that the tenant is successfully created.

.. |image1| image:: /_static/images/en-us_image_0000001392733934.png
